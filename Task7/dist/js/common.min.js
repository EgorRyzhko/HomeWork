"use strict";function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function Book(e,t,n,o,i,r){this.title=e,this.publishingHouse=t,this.author=n,this.releasingYear=o,this.genre=i,this.price=r,this.setTitle=function(e){this.title=e},this.getTitle=function(){return this.title},this.setPublishingHouse=function(e){this.publishingHouse=e},this.getPublishingHouse=function(){return this.publishingHouse},this.setAuthor=function(e){this.author=e},this.getAuthor=function(){return this.author},this.setReleasingYear=function(e){this.releasingYear=e},this.getReleasingYear=function(){return this.releasingYear},this.setGenre=function(e){this.genre=e},this.getGenre=function(){return this.genre},this.setPrice=function(e){this.price=e},this.getPrice=function(){return this.price}}function Audiobook(e,t){Book.call(this),this.discType=e,this.fileFormat=t,this.setDiscType=function(e){this.discType=e},this.getDiscType=function(){return this.discType},this.setFileFormat=function(e){this.fileFormat=e},this.getFileFormat=function(){return this.fileFormat}}function Textbook(e,t){Book.call(this),this.branchOfScience=e,this.bindingType=t,this.setBranchOfScience=function(e){this.branchOfScience=e},this.getBranchOfScience=function(){return this.branchOfScience},this.setBindingType=function(e){this.bindingType=e},this.getBindingType=function(){return this.bindingType}}function search(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"наука";if(0!=e.length){var n=document.createElement("div");n.id="searching_container",n.innerHTML="<h1>Результаты поиска:</h1>";var o=document.createElement("table");o.id="serching_result";var i=document.createElement("tr");i.innerHTML="<th>Название книги</th><th>Издательство</th><th>Автор</th><th>Год изданиия</th>             <th>Жанр</th>",o.appendChild(i);for(var r=0;r<e.length;r++){var d=document.createElement("tr"),a=e[r],c=a.title,l=a.author,u=a.genre;if(c.toLowerCase()==t||l.toLowerCase()==t||u.toLowerCase()==t)for(key in e[r])"title"!=key&&"publishingHouse"!=key&&"author"!=key&&"releasingYear"!=key&&"genre"!=key||(d.innerHTML+="<td>"+e[r][key]+"</td>");""!=d.innerHTML&&o.appendChild(d)}null!=o.rows[1]&&(n.appendChild(o),document.body.appendChild(n))}}function searchReq(){fetch("http://localhost:2403/books").then(function(e){return e.json()}).then(function(e){null!=document.getElementById("searching_container")&&document.getElementById("searching_container").remove(),""==document.getElementById("searching").value&&search(e),search(e,document.getElementById("searching").value.toLowerCase())}).catch(function(e){return console.error("Error:",e)})}function editData(e){function t(e){return e.title=n.document.getElementById("edit_title").value,e.publishingHouse=n.document.getElementById("edit_publishing_house").value,e.author=n.document.getElementById("edit_author").value,e.releasingYear=n.document.getElementById("edit_releasing_year").value,e.genre=n.document.getElementById("edit_genre").value,e.price=n.document.getElementById("edit_price").value,"discType"in e&&(e.discType=n.document.getElementById("edit_disc_type").value,e.fileFormat=n.document.getElementById("edit_file_format").value),"bindingType"in e&&(e.bindingType=n.document.getElementById("edit_binding_type").value,e.branchOfScience=n.document.getElementById("edit_branch_of_science").value),e}var n=window.open("editData.html","editData","width=430,height=600");n.onload=function(){n.document.getElementById("edit_title").value=e.title,n.document.getElementById("edit_publishing_house").value=e.publishingHouse,n.document.getElementById("edit_author").value=e.author,n.document.getElementById("edit_releasing_year").value=e.releasingYear,n.document.getElementById("edit_genre").value=e.genre,n.document.getElementById("edit_price").value=e.price,"discType"in e&&(n.document.getElementById("edit_book_type").value="Аудиокнига",n.document.getElementById("edit_disc_type").value=e.discType,n.document.getElementById("edit_file_format").value=e.fileFormat),"bindingType"in e&&(n.document.getElementById("hide-show_edit_textbook").style.display="",n.document.getElementById("hide-show_edit_audiobook").style.display="none",n.document.getElementById("edit_book_type").value="Учебник",n.document.getElementById("edit_binding_type").value=e.bindingType,n.document.getElementById("edit_branch_of_science").value=e.branchOfScience),n.document.getElementById("save_changes_btn").addEventListener("click",function(){var o=n.document.getElementById("edit_title").value,i=n.document.getElementById("edit_publishing_house").value,r=n.document.getElementById("edit_author").value,d=n.document.getElementById("edit_releasing_year").value,a=n.document.getElementById("edit_price").value;""!=o&&""!=i&&""!=r&&""!=d&&""!=a&&(fetch("http://localhost:2403/books",{method:"PUT",body:JSON.stringify(t(e)),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){console.log("Success:",JSON.stringify(e)),document.getElementById("books_data").remove(),document.getElementById("create_btn").remove(),getBooksData()}).catch(function(e){return console.error("Error:",e)}),n.close())})}}function editDataReq(e){fetch("http://localhost:2403/books").then(function(e){return e.json()}).then(function(t){editData(t.filter(function(t){return t.id==e})[0])}).catch(function(e){return console.error("Error:",e)})}function checkEvent(e){for(var t=$(e.currentTarget),n=$(e.target);!n.is(t);){if("delete"===n.attr("data-option"))return child=n.parent().parent(),void deleteData(child[0].book_id);if("edit"===n.attr("data-option"))return child=n.parent().parent(),void editDataReq(child[0].book_id);if("get_data"===n.attr("data-option"))return child=n.parent().parent(),void getFullDataReq(child[0].book_id);n=n.parent()}}function deleteData(e){confirm("Вы действительно желаете удалить данную запись?")&&fetch("http://localhost:2403/books/"+e,{method:"DELETE"}).then(function(e){return e.json()}).then(function(){document.getElementById("books_data").remove(),document.getElementById("create_btn").remove(),getBooksData()}).catch(function(e){return console.error("Error:",e)})}function getFullData(e){var t=window.open("getFullData.html","getFullData","width=430,height=600");t.onload=function(){var n=t.document.createElement("h1");n.innerHTML="Подробная информация:";var o=document.createElement("table"),i=t.document.body,r=e.title,d=e.publishingHouse,a=e.author,c=e.releasingYear,l=e.genre,u=e.price;o.innerHTML="<tr><td>Название книги</td><td></td></tr>",o.innerHTML+="<tr><td>Тип книги</td><td></td></tr>",o.innerHTML+="<tr><td>Издательство</td><td></td></tr>",o.innerHTML+="<tr><td>Автор</td><td></td></tr>",o.innerHTML+="<tr><td>Год издания</td><td></td></tr>",o.innerHTML+="<tr><td>Жанр</td><td></td></tr>",o.innerHTML+="<tr><td>Стоимость</td><td></td></tr>","discType"in e&&(o.rows[1].cells[1].innerHTML="Аудиокнига",o.innerHTML+="<tr><td>Тип диска</td><td></td></tr>",o.innerHTML+="<tr><td>Формат файла</td><td></td></tr>"),"branchOfScience"in e&&(o.rows[1].cells[1].innerHTML="Учебник",o.innerHTML+="<tr><td>Область науки</td><td></td></tr>",o.innerHTML+="<tr><td>Тип переплета</td><td></td></tr>"),o.rows[0].cells[1].innerHTML=r,o.rows[2].cells[1].innerHTML=d,o.rows[3].cells[1].innerHTML=a,o.rows[4].cells[1].innerHTML=c,o.rows[5].cells[1].innerHTML=l,o.rows[6].cells[1].innerHTML=u,"discType"in e&&(o.rows[7].cells[1].innerHTML=e.discType,o.rows[8].cells[1].innerHTML=e.fileFormat),"branchOfScience"in e&&(o.rows[7].cells[1].innerHTML=e.branchOfScience,o.rows[8].cells[1].innerHTML=e.bindingType),i.appendChild(n),i.appendChild(o)}}function getFullDataReq(e){fetch("http://localhost:2403/books").then(function(e){return e.json()}).then(function(t){return getFullData(t.filter(function(t){return t.id==e})[0])}).catch(function(e){return console.error("Error",e)})}function showBooksData(e){if(document.body.innerHTML+='<a href="createElem.html" id="create_btn">Создать</a>',0!=e.length){var t=_toArray(e),n=t.slice(0),o=document.createElement("table");o.id="books_data";var i=document.createElement("tr");i.innerHTML="<th>Название книги</th><th>Издательство</th><th>Автор</th><th>Год изданиия</th>             <th>Жанр</th><th></th><th></th>",o.appendChild(i);for(var r=0;r<n.length;r++){var d=document.createElement("tr");d.book_id=n[r].id;for(var a in n[r])"title"!=a&&"publishingHouse"!=a&&"author"!=a&&"releasingYear"!=a&&"genre"!=a||(d.innerHTML+="<td>"+n[r][a]+"</td>");d.innerHTML+='<td><a href="#" class="option_link" data-option="edit">Редактировать</a>             <a href="#" class="option_link" data-option="delete">Удалить</a></td>',d.innerHTML+='<td><a href="#" class="option_link" data-option="get_data">Подробнее</a></td>',o.appendChild(d)}document.body.appendChild(o)}}function getBooksData(){fetch("http://localhost:2403/books").then(function(e){return e.json()}).then(function(e){return showBooksData(e)}).catch(function(e){return console.error("Error:",e)})}function search(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"наука";if(0!=e.length){var n=document.createElement("div");n.id="searching_container",n.innerHTML="<h1>Результаты поиска:</h1>";var o=document.createElement("table");o.id="serching_result";var i=document.createElement("tr");i.innerHTML="<th>Название книги</th><th>Издательство</th><th>Автор</th><th>Год изданиия</th>             <th>Жанр</th>",o.appendChild(i);for(var r=0;r<e.length;r++){var d=document.createElement("tr"),a=e[r],c=a.title,l=a.author,u=a.genre;if(c.toLowerCase()==t||l.toLowerCase()==t||u.toLowerCase()==t)for(key in e[r])"title"!=key&&"publishingHouse"!=key&&"author"!=key&&"releasingYear"!=key&&"genre"!=key||(d.innerHTML+="<td>"+e[r][key]+"</td>");""!=d.innerHTML&&o.appendChild(d)}null!=o.rows[1]&&(n.appendChild(o),document.body.appendChild(n))}}function searchReq(){fetch("http://localhost:2403/books").then(function(e){return e.json()}).then(function(e){null!=document.getElementById("searching_container")&&document.getElementById("searching_container").remove(),""==document.getElementById("searching").value&&search(e),search(e,document.getElementById("searching").value.toLowerCase())}).catch(function(e){return console.error("Error:",e)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.searchReq=searchReq,exports.search=search;var test_var=15,deleteInfo=function(){document.getElementById("title").value="",document.getElementById("publishing_house").value="",document.getElementById("author").value="",document.getElementById("releasing_year").value="",document.getElementById("price").value=""},addNewInputsInCreatePage=function(){"Аудиокнига"==document.getElementById("book_type").value&&(document.getElementById("hide-show_textbook").style.display="none",document.getElementById("hide-show_audiobook").style.display=""),"Учебник"==document.getElementById("book_type").value&&(document.getElementById("hide-show_audiobook").style.display="none",document.getElementById("hide-show_textbook").style.display="")},createNewBook=function(){var e=document.getElementById("title").value,t=document.getElementById("publishing_house").value,n=document.getElementById("author").value,o=document.getElementById("releasing_year").value,i=document.getElementById("price").value;if(""!=e&&""!=t&&""!=n&&""!=o&&""!=i){if("Аудиокнига"==document.getElementById("book_type").value){var r=new Audiobook(document.getElementById("disc_type").value,document.getElementById("file_format").value);r.setTitle(e),r.setPublishingHouse(t),r.setAuthor(n),r.setReleasingYear(o),r.setGenre(document.getElementById("genre").value),r.setPrice(i),fetch("http://localhost:2403/books",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return console.log("Success:",JSON.stringify(e))}).catch(function(e){return console.error("Error:",e)})}if("Учебник"==document.getElementById("book_type").value){var d=new Textbook(document.getElementById("branch_of_science").value,document.getElementById("binding_type").value);d.setTitle(e),d.setPublishingHouse(t),d.setAuthor(n),d.setReleasingYear(o),d.setGenre(document.getElementById("genre").value),d.setPrice(i),fetch("http://localhost:2403/books",{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return console.log("Success:",JSON.stringify(e))}).catch(function(e){return console.error("Error:",e)})}}};document.getElementById("save_btn").addEventListener("click",createNewBook),document.getElementById("delete_btn").addEventListener("click",deleteInfo),document.getElementById("book_type").addEventListener("change",addNewInputsInCreatePage),document.addEventListener("click",checkEvent);